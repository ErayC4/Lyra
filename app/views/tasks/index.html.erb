<style>
  /* Behalte die vorhandenen Stiele bei und füge folgende hinzu: */
  p{
    padding: 0;
    margin: 0;
  }
  .grid-container {
    position: relative;
    display: grid;
    grid-template-columns: repeat(7, 1fr); /* 7 Tage */
    grid-template-rows: repeat(24, 60px); /* 24 Stunden each 60px  für 1minute*/
    border-left: 1px solid #DBDBDB;
    border-top: 1px solid #DBDBDB;
  }

  .grid-item {
    border-right: 1px solid #DBDBDB;
    border-bottom: 1px solid #DBDBDB;
    box-sizing: border-box;
  }

  .weekdays-navbar-container {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    border-right: 1px solid #DBDBDB;
    border-bottom: 1px solid #DBDBDB;

  }

  .weekday-item {
    display: flex;
    flex-direction: column;
    justify-content: center; /* Zentriert die Elemente vertikal */
    align-items: center; /* Zentriert die Elemente horizontal */
    border-left: 1px solid #DBDBDB;
    padding: 16px 0;
  }
  .weekday-active{
    font-weight: bold;
  }
  .day{
    font-size: 1.75rem;
    border-radius: 999px;
    width: 44px;
    height: 44px;
    align-items: center;
    display: flex;
    justify-content: center;
    margin-top: 8px;
  }
  .day-active{
    font-size: 1.75rem;
    background-color: black;
    color: white;
    border-radius: 999px;
    width: 44px;
    height: 44px;
    align-items: center;
    display: flex;
    justify-content: center;
    margin-top: 8px;
  }

  .task {
    position: absolute;
    background-color: #a4bdfc;
    border-left: 4px solid #1e66d4;
    border-radius: 4px;
    padding: 4px 8px;
    font-size: 12px;
    color: black;
    overflow: hidden;
    z-index: 1;
    cursor: pointer;
    box-sizing: border-box;
    transition: filter 0.2s;
  }

  .task:hover {
    filter: brightness(95%);
  }

  .task-title {
    font-weight: 500;
    margin: 0;
  }
</style>


<% def days_in_month(year, month) %>
  <%= Date.new(year, month, -1).day %>
<% end %>

<% # Startdatum (Anfang der Woche) festlegen %>
<% current_date = Date.today %>
<% current_weekday = (current_date.wday  - 1) % 7 %>
<!-- Container für den gesamten Kalender -->
<div class="container">
  <!-- Wochentage oben -->
  <div class="weekdays-navbar-container">
    <% (0..6).each do |day| %>
      <div class="weekday-item">
        <% target_date = current_date + (day - current_weekday) %>
        <p style="font-weight: <%= current_weekday == day ? "bold" : "normal" %>"><%= (target_date).strftime("%a") %><p>
        <% if current_weekday == day %>
        <div class="day-active">
          <%= target_date.day %>
        </div>
        <% else %>
          <div class="day">
            <%= target_date.day %>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

  <!-- Grid-Container für Stunden und Tage -->
  <div class="grid-container">
    <%# Grid Items für das Hintergrundgitter %>
    <% (0..6).each do |day| %>
      <% (0..23).each do |hour| %>
        <div class="grid-item"></div>
      <% end %>
    <% end %>

    <% @tasks.each do |task| %>
      <%= task.title %>
      <%= task.time['starting_time'] %>
      <%= task.time['ending_time'] %>
      <%= task.time['repeat_on_day'] %>
    <% end %>
    <%# Tasks mit absoluter Positionierung und festen Werten %>
    <% 
      # Beispielwerte für die Variablen
      start_h = 10.5 # Beispiel: 10:30 Uhr
      end_h = 12.0   # Beispiel: 12:00 Uhr
      day_offset = 2 # Beispiel: Tag 3 (Mittwoch)
      column_width = 100.0 / 7
      top = start_h * 60
      height = (end_h - start_h) * 60
      left = day_offset * column_width
    %>
    <div class="task" 
         style="left: <%= left %>%; 
                width: <%= column_width %>%;
                top: <%= top %>px;
                height: <%= height %>px;">
      <p class="task-title">Meeting</p>
      <p>Konferenzraum 1</p>
    </div>

    <% 
      # Zweiter Task mit anderen Werten
      start_h = 14.0 # Beispiel: 14:00 Uhr
      end_h = 15.5   # Beispiel: 15:30 Uhr
      day_offset = 4 # Beispiel: Tag 5 (Freitag)
      top = start_h * 60
      height = (end_h - start_h) * 60
      left = day_offset * column_width
    %>

    <div class="task" 
         style="left: <%= left %>%; 
                width: <%= column_width %>%;
                top: <%= top %>px;
                height: <%= height %>px;">
      <p class="task-title">Projektbesprechung</p>
      <p>Zoom</p>
    </div>
  </div>
</div>